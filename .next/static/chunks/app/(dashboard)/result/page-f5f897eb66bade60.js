(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[34],{468:(e,s,l)=>{Promise.resolve().then(l.bind(l,81486))},81486:(e,s,l)=>{"use strict";l.r(s),l.d(s,{default:()=>E});var t=l(95155),r=l(12115),a=l(34982),n=l(83540),i=l(93490),o=l(94754),c=l(96025),d=l(52071),x=l(69754),m=l(3350),h=l(87156);let p=(0,a.UU)("https://filyujdgxtjoqkebvegb.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZpbHl1amRneHRqb3FrZWJ2ZWdiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTA3NTk1NjAsImV4cCI6MjA2NjMzNTU2MH0.2-CROlvK_eQYoIvI9PqRRmLGOfLD2TQnsQfwMAyxJ0k"),u={temp:{label:"อุณหภูมิ",unit:"\xb0C",colors:["#ef4444","#dc2626","#b91c1c"]},humid:{label:"ความชื้น",unit:"%",colors:["#3b82f6","#2563eb","#1d4ed8"]},wt:{label:"อุณหภูมิน้ำ",unit:"\xb0C",colors:["#06b6d4","#0891b2","#0e7490"]},ph:{label:"pH",unit:"",colors:["#8b5cf6","#7c3aed","#6d28d9"]},ec:{label:"EC",unit:"EC",colors:["#10b981","#059669","#047857"]},lux:{label:"แสง",unit:"lux",colors:["#f59e0b","#d97706","#b45309"]}},f=new Map;function b(e){let{active:s,payload:l,label:r}=e;return s&&l&&0!==l.length?(0,t.jsxs)("div",{className:"bg-slate-800 border border-slate-600 rounded-lg shadow-lg p-3",children:[(0,t.jsx)("p",{className:"font-medium text-white mb-2",children:"เวลา: ".concat(null!=r?r:"")}),l.map((e,s)=>(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,t.jsx)("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:e.color}}),(0,t.jsxs)("span",{className:"text-gray-300",children:[e.name,": ",(0,t.jsx)("span",{className:"font-medium text-white",children:"number"==typeof e.value?e.value.toFixed(2):"N/A"})]})]},s))]}):null}function g(e){let{sensorKey:s="ph",rangeHours:l=24,height:a=400,showHeader:g=!0,compact:j=!1}=e,[N,y]=(0,r.useState)([]),[v,k]=(0,r.useState)(!0),[w,C]=(0,r.useState)(null),S=(0,r.useMemo)(()=>"".concat(s,"-").concat(l),[s,l]),A=(0,r.useCallback)(async()=>{try{C(null);let e=f.get(S),s=Date.now();if(e&&s-e.timestamp<3e4){y(e.data),k(!1);return}k(!0);let t=new Date(Date.now()-60*l*6e4).toISOString(),{data:r,error:a}=await p.from("sensor_logs").select("*").gte("created_at",t).order("created_at",{ascending:!0});if(a)throw Error(a.message);let n=r||[];f.set(S,{data:n,timestamp:s}),y(n),k(!1)}catch(e){console.error("Error fetching data:",e),C(e instanceof Error?e.message:"Unknown error"),k(!1)}},[S,l]);(0,r.useEffect)(()=>{let e=!0;return(async()=>{e&&await A()})(),()=>{e=!1}},[A]);let I=(0,r.useMemo)(()=>{if(0===N.length)return[];let e={};return N.forEach(l=>{var t,r,a;let n=new Date(l.created_at),i="".concat(n.getHours().toString().padStart(2,"0"),":").concat(n.getMinutes().toString().padStart(2,"0"));e[i]||(e[i]={time:i,floor1:null,floor2:null,floor3:null}),1===l.floor?e[i].floor1=null!=(t=l[s])?t:null:2===l.floor?e[i].floor2=null!=(r=l[s])?r:null:3===l.floor&&(e[i].floor3=null!=(a=l[s])?a:null)}),Object.values(e).sort((e,s)=>e.time.localeCompare(s.time)).filter(e=>null!==e.floor1||null!==e.floor2||null!==e.floor3)},[N,s]);if(v)return(0,t.jsx)("div",{className:"flex items-center justify-center ".concat(j?"bg-transparent":"bg-slate-900 rounded-2xl"),style:{height:a},children:(0,t.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-500"}),(0,t.jsx)("p",{className:"text-gray-400 text-sm",children:"กำลังโหลดข้อมูล..."})]})});if(w)return(0,t.jsx)("div",{className:"flex items-center justify-center text-red-400 ".concat(j?"bg-transparent":"bg-slate-900 rounded-2xl"),style:{height:a},children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-4xl mb-2",children:"⚠️"}),(0,t.jsx)("div",{className:"text-white mb-2",children:"เกิดข้อผิดพลาด"}),(0,t.jsx)("div",{className:"text-sm",children:w}),(0,t.jsx)("button",{onClick:A,className:"mt-3 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:"ลองใหม่"})]})});if(0===I.length)return(0,t.jsx)("div",{className:"flex items-center justify-center text-gray-400 ".concat(j?"bg-transparent":"bg-slate-900 rounded-2xl"),style:{height:a},children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-4xl mb-2",children:"\uD83D\uDCCA"}),(0,t.jsx)("div",{className:"text-white mb-2",children:"ไม่มีข้อมูล"}),(0,t.jsxs)("div",{className:"text-sm",children:["ช่วง ",l," ชั่วโมงล่าสุด"]}),(0,t.jsx)("button",{onClick:A,className:"mt-3 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:"รีเฟรช"})]})});let G=u[s];return(0,t.jsxs)("div",{className:"w-full ".concat(j?"bg-transparent":"bg-slate-900 rounded-2xl p-6 border border-slate-700"),children:[g&&(0,t.jsxs)("div",{className:"mb-6 flex justify-between items-start",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"".concat(j?"text-lg":"text-2xl"," font-bold text-white mb-1"),children:G.label}),(0,t.jsxs)("p",{className:"text-sm text-gray-400",children:["หน่วย: ",G.unit||"ไม่มีหน่วย"," • ช่วง ",l," ชั่วโมงล่าสุด"]})]}),(0,t.jsx)("button",{onClick:A,className:"px-3 py-1 text-xs bg-slate-700 text-gray-300 rounded-lg hover:bg-slate-600 transition-colors",disabled:v,children:v?"กำลังโหลด...":"รีเฟรช"})]}),(0,t.jsx)(n.u,{width:"100%",height:a,children:(0,t.jsxs)(i.Q,{data:I,margin:{top:j?10:20,right:j?15:30,left:j?10:20,bottom:j?10:20},children:[(0,t.jsxs)("defs",{children:[(0,t.jsxs)("linearGradient",{id:"floor1Gradient-".concat(s),x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,t.jsx)("stop",{offset:"5%",stopColor:G.colors[0],stopOpacity:.8}),(0,t.jsx)("stop",{offset:"95%",stopColor:G.colors[0],stopOpacity:.1})]}),(0,t.jsxs)("linearGradient",{id:"floor2Gradient-".concat(s),x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,t.jsx)("stop",{offset:"5%",stopColor:G.colors[1],stopOpacity:.8}),(0,t.jsx)("stop",{offset:"95%",stopColor:G.colors[1],stopOpacity:.1})]}),(0,t.jsxs)("linearGradient",{id:"floor3Gradient-".concat(s),x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,t.jsx)("stop",{offset:"5%",stopColor:G.colors[2],stopOpacity:.8}),(0,t.jsx)("stop",{offset:"95%",stopColor:G.colors[2],stopOpacity:.1})]})]}),(0,t.jsx)(o.d,{strokeDasharray:"3 3",stroke:"#374151",opacity:.7,horizontal:!0,vertical:!0}),(0,t.jsx)(c.W,{dataKey:"time",fontSize:j?10:12,tick:{fill:"#9ca3af",fontWeight:500},axisLine:{stroke:"#4b5563"},tickLine:{stroke:"#4b5563"},minTickGap:j?10:20}),(0,t.jsx)(d.h,{fontSize:j?10:12,tick:{fill:"#9ca3af",fontWeight:500},axisLine:{stroke:"#4b5563"},tickLine:{stroke:"#4b5563"},domain:"ph"===s?[0,8]:["auto","auto"],width:j?30:40}),(0,t.jsx)(x.m,{content:(0,t.jsx)(b,{}),cursor:{fill:"#1e293b",opacity:.2}}),!j&&(0,t.jsx)(m.s,{wrapperStyle:{paddingTop:20},iconType:"circle",align:"center",verticalAlign:"top"}),(0,t.jsx)(h.Gk,{type:"monotone",dataKey:"floor1",stroke:G.colors[0],strokeWidth:2,fill:"url(#floor1Gradient-".concat(s,")"),name:"ชั้น 1",connectNulls:!1,dot:!j&&{fill:G.colors[0],strokeWidth:2,r:4},activeDot:{r:6,fill:G.colors[0]}}),(0,t.jsx)(h.Gk,{type:"monotone",dataKey:"floor2",stroke:G.colors[1],strokeWidth:2,fill:"url(#floor2Gradient-".concat(s,")"),name:"ชั้น 2",connectNulls:!1,dot:!j&&{fill:G.colors[1],strokeWidth:2,r:4},activeDot:{r:6,fill:G.colors[1]}}),(0,t.jsx)(h.Gk,{type:"monotone",dataKey:"floor3",stroke:G.colors[2],strokeWidth:2,fill:"url(#floor3Gradient-".concat(s,")"),name:"ชั้น 3",connectNulls:!1,dot:!j&&{fill:G.colors[2],strokeWidth:2,r:4},activeDot:{r:6,fill:G.colors[2]}})]})}),!j&&(0,t.jsx)("div",{className:"mt-6 flex justify-center",children:(0,t.jsxs)("div",{className:"flex items-center gap-6 text-sm",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:G.colors[0]}}),(0,t.jsx)("span",{className:"text-gray-300",children:"ชั้น 1"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:G.colors[1]}}),(0,t.jsx)("span",{className:"text-gray-300",children:"ชั้น 2"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:G.colors[2]}}),(0,t.jsx)("span",{className:"text-gray-300",children:"ชั้น 3"})]})]})})]})}var j=l(72111),N=l(71539),y=l(44992),v=l(48691),k=l(30790),w=l(62098),C=l(72713),S=l(54653),A=l(15968),I=l(94498);let G=[{key:"ph",label:"pH",icon:j.A},{key:"ec",label:"EC",icon:N.A},{key:"temp",label:"อุณหภูมิ",icon:y.A},{key:"humid",label:"ความชื้น",icon:v.A},{key:"wt",label:"อุณหภูมิน้ำ",icon:k.A},{key:"lux",label:"แสง",icon:w.A}],O=[{key:"single",label:"Single",icon:C.A},{key:"grid",label:"Grid",icon:S.A},{key:"list",label:"List",icon:A.A},{key:"compare",label:"Compare",icon:I.A}];function E(){let[e,s]=(0,r.useState)("ph"),[l,a]=(0,r.useState)("single"),[n,i]=(0,r.useState)(!0);(0,r.useEffect)(()=>{let e=setTimeout(()=>{i(!1)},100);return()=>clearTimeout(e)},[]);let o=G.find(s=>s.key===e),c=(null==o?void 0:o.icon)||C.A;return n?(0,t.jsx)("div",{className:"min-h-screen bg-slate-950 p-4 md:p-6 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"}),(0,t.jsx)("span",{className:"text-slate-400 text-lg",children:"Loading results..."})]})}):(0,t.jsx)("div",{className:"min-h-screen bg-slate-950 p-4 md:p-6",children:(0,t.jsxs)("div",{className:"w-full max-w-7xl mx-auto space-y-6",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 items-center justify-between",children:[(0,t.jsx)("div",{className:"flex items-center gap-2 bg-slate-800 rounded-xl p-1",children:O.map(e=>{let s=e.icon;return(0,t.jsxs)("button",{onClick:()=>a(e.key),className:"\n                    flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-all duration-200\n                    ".concat(l===e.key?"bg-slate-700 text-white shadow-sm":"text-gray-400 hover:text-white","\n                  "),children:[(0,t.jsx)(s,{className:"w-4 h-4"}),(0,t.jsx)("span",{className:"hidden sm:inline",children:e.label})]},e.key)})}),"single"===l&&(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:G.map(l=>{let r=l.icon,a=e===l.key;return(0,t.jsxs)("button",{onClick:()=>s(l.key),className:"\n                      flex items-center gap-2 px-3 md:px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200\n                      ".concat(a?"bg-purple-600 text-white":"bg-slate-800 text-gray-300 hover:bg-slate-700 border border-slate-600","\n                    "),children:[(0,t.jsx)(r,{className:"w-4 h-4"}),(0,t.jsx)("span",{className:"hidden sm:inline",children:l.label})]},l.key)})})]}),"single"===l&&(0,t.jsx)(D,{sensor:e,currentSensor:o,CurrentIcon:c}),"grid"===l&&(0,t.jsx)(W,{}),"list"===l&&(0,t.jsx)(_,{}),"compare"===l&&(0,t.jsx)(H,{})]})})}function D(e){let{sensor:s,currentSensor:l,CurrentIcon:r}=e;return(0,t.jsxs)("div",{className:"bg-slate-900 rounded-2xl shadow-lg border border-slate-700 overflow-hidden",children:[(0,t.jsx)("div",{className:"px-4 md:px-6 py-4 border-b border-slate-700",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"p-2 bg-slate-800 rounded-lg",children:(0,t.jsx)(r,{className:"w-5 h-5 text-purple-400"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-white",children:null==l?void 0:l.label}),(0,t.jsx)("p",{className:"text-gray-400 text-sm",children:"เปรียบเทียบข้อมูล 3 ชั้น"})]})]})}),(0,t.jsx)("div",{className:"p-4 md:p-6",children:(0,t.jsx)(g,{sensorKey:s})})]})}function W(){return(0,t.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:G.map(e=>{let s=e.icon;return(0,t.jsxs)("div",{className:"bg-slate-900 rounded-xl border border-slate-700 overflow-hidden min-h-[300px]",children:[(0,t.jsx)("div",{className:"px-4 py-3 border-b border-slate-700 bg-slate-800",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(s,{className:"w-4 h-4 text-purple-400"}),(0,t.jsx)("h3",{className:"font-medium text-white text-sm truncate",children:e.label})]})}),(0,t.jsx)("div",{className:"p-3",children:(0,t.jsx)(g,{sensorKey:e.key,height:220,showHeader:!1,compact:!0})})]},e.key)})})}function _(){return(0,t.jsx)("div",{className:"space-y-4",children:G.map(e=>{let s=e.icon;return(0,t.jsxs)("div",{className:"bg-slate-900 rounded-xl border border-slate-700 overflow-hidden",children:[(0,t.jsx)("div",{className:"px-4 md:px-6 py-4 border-b border-slate-700",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"p-2 bg-slate-800 rounded-lg",children:(0,t.jsx)(s,{className:"w-5 h-5 text-purple-400"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold text-white",children:e.label}),(0,t.jsx)("p",{className:"text-gray-400 text-sm",children:"Real-time monitoring"})]})]})}),(0,t.jsx)("div",{className:"p-4",children:(0,t.jsx)(g,{sensorKey:e.key,height:280,showHeader:!1,compact:!1})})]},e.key)})})}function H(){let[e,s]=(0,r.useState)(["ph","temp"]),l=e=>{s(s=>s.includes(e)?s.filter(s=>s!==e):s.length<4?[...s,e]:s)};return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"bg-slate-800 rounded-xl p-4",children:[(0,t.jsx)("h3",{className:"text-sm font-medium text-white mb-3",children:"เลือกเซ็นเซอร์เพื่อเปรียบเทียบ (สูงสุด 4 อัน)"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:G.map(s=>{let r=s.icon,a=e.includes(s.key);return(0,t.jsxs)("button",{onClick:()=>l(s.key),className:"\n                  flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-all duration-200\n                  ".concat(a?"bg-purple-600 text-white":"bg-slate-700 text-gray-300 hover:bg-slate-600","\n                "),children:[(0,t.jsx)(r,{className:"w-4 h-4"}),(0,t.jsx)("span",{className:"hidden sm:inline",children:s.label})]},s.key)})})]}),(0,t.jsx)("div",{className:"grid gap-4 ".concat(1===e.length?"grid-cols-1":2===e.length?"grid-cols-1 lg:grid-cols-2":3===e.length?"grid-cols-1 md:grid-cols-2 xl:grid-cols-3":"grid-cols-1 md:grid-cols-2"),children:e.map(e=>{let s=G.find(s=>s.key===e),l=(null==s?void 0:s.icon)||C.A;return(0,t.jsxs)("div",{className:"bg-slate-900 rounded-xl border border-slate-700 overflow-hidden min-h-[320px]",children:[(0,t.jsx)("div",{className:"px-4 py-3 border-b border-slate-700",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(l,{className:"w-4 h-4 text-purple-400"}),(0,t.jsx)("h3",{className:"font-medium text-white",children:null==s?void 0:s.label})]})}),(0,t.jsx)("div",{className:"p-4",children:(0,t.jsx)(g,{sensorKey:e,height:240,showHeader:!1,compact:!0})})]},e)})})]})}}},e=>{var s=s=>e(e.s=s);e.O(0,[982,311,671,441,684,358],()=>s(468)),_N_E=e.O()}]);