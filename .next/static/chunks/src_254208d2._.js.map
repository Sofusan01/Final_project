{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///D:/Dashboard/dashboard/src/components/UserProfileMenu.tsx"],"sourcesContent":["// src/components/UserProfileMenu.tsx\r\nimport { useState, useRef, useEffect } from \"react\";\r\nimport { User, LogOut, ChevronUp, ChevronDown } from \"lucide-react\";\r\n\r\ninterface UserProfileMenuProps {\r\n    collapsed: boolean;\r\n    user: { firstName: string; lastName: string } | null;\r\n    onLogout: () => void;\r\n}\r\n\r\nfunction UserProfileMenu({ collapsed, user, onLogout }: UserProfileMenuProps) {\r\n    const [open, setOpen] = useState(false);\r\n    const ref = useRef<HTMLDivElement>(null);\r\n\r\n    // ปิด dropdown เมื่อคลิกนอก\r\n    useEffect(() => {\r\n        function handleClick(e: MouseEvent) {\r\n            if (!ref.current?.contains(e.target as Node)) setOpen(false);\r\n        }\r\n        if (open) window.addEventListener(\"mousedown\", handleClick);\r\n        return () => window.removeEventListener(\"mousedown\", handleClick);\r\n    }, [open]);\r\n\r\n    // แสดงชื่อผู้ใช้\r\n    const displayName = user ? `${user.firstName} ${user.lastName}`.trim() : \"Loading...\";\r\n\r\n    if (collapsed) {\r\n        return (\r\n            <div className=\"flex justify-center\">\r\n                <button\r\n                    className=\"w-10 h-10 rounded-full bg-blue-900 hover:bg-blue-800 flex items-center justify-center shadow group relative\"\r\n                    title={displayName}\r\n                >\r\n                    <User className=\"w-6 h-6 text-white\" />\r\n                    {/* Tooltip */}\r\n                    <span className=\"absolute left-full ml-3 top-1/2 -translate-y-1/2 bg-slate-800 text-white px-3 py-1 rounded shadow opacity-0 group-hover:opacity-100 text-xs pointer-events-none whitespace-nowrap z-50\">\r\n                        {displayName}\r\n                    </span>\r\n                </button>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"relative\" ref={ref}>\r\n            <button\r\n                onClick={() => setOpen((v) => !v)}\r\n                className=\"w-full flex items-center gap-3 px-3 py-2 rounded-lg bg-blue-900/80 hover:bg-blue-800/90 text-white transition\"\r\n            >\r\n                <User className=\"w-6 h-6\" />\r\n                <span className=\"font-semibold text-sm truncate\">\r\n                    {displayName}\r\n                </span>\r\n                {open ? (\r\n                    <ChevronUp className=\"ml-auto w-4 h-4 flex-shrink-0\" />\r\n                ) : (\r\n                    <ChevronDown className=\"ml-auto w-4 h-4 flex-shrink-0\" />\r\n                )}\r\n            </button>\r\n            {open && (\r\n                <div className=\"absolute left-0 bottom-full mb-2 w-full rounded-lg bg-slate-900/95 shadow-xl ring-1 ring-blue-700/30 z-50\">\r\n                    <button\r\n                        className=\"flex items-center w-full px-4 py-2 text-sm text-red-400 hover:text-red-600 hover:bg-red-50/10 rounded-lg transition\"\r\n                        onClick={onLogout}\r\n                    >\r\n                        <LogOut className=\"w-4 h-4 mr-2\" />\r\n                        ออกจากระบบ\r\n                    </button>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default UserProfileMenu;\r\n"],"names":[],"mappings":"AAAA,qCAAqC;;;;;AACrC;AACA;AAAA;AAAA;AAAA;;;;;AAQA,SAAS,gBAAgB,EAAE,SAAS,EAAE,IAAI,EAAE,QAAQ,EAAwB;;IACxE,MAAM,CAAC,MAAM,QAAQ,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IACjC,MAAM,MAAM,CAAA,GAAA,6JAAA,CAAA,SAAM,AAAD,EAAkB;IAEnC,4BAA4B;IAC5B,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;qCAAE;YACN,SAAS,YAAY,CAAa;gBAC9B,IAAI,CAAC,IAAI,OAAO,EAAE,SAAS,EAAE,MAAM,GAAW,QAAQ;YAC1D;YACA,IAAI,MAAM,OAAO,gBAAgB,CAAC,aAAa;YAC/C;6CAAO,IAAM,OAAO,mBAAmB,CAAC,aAAa;;QACzD;oCAAG;QAAC;KAAK;IAET,iBAAiB;IACjB,MAAM,cAAc,OAAO,GAAG,KAAK,SAAS,CAAC,CAAC,EAAE,KAAK,QAAQ,EAAE,CAAC,IAAI,KAAK;IAEzE,IAAI,WAAW;QACX,qBACI,6LAAC;YAAI,WAAU;sBACX,cAAA,6LAAC;gBACG,WAAU;gBACV,OAAO;;kCAEP,6LAAC,qMAAA,CAAA,OAAI;wBAAC,WAAU;;;;;;kCAEhB,6LAAC;wBAAK,WAAU;kCACX;;;;;;;;;;;;;;;;;IAKrB;IAEA,qBACI,6LAAC;QAAI,WAAU;QAAW,KAAK;;0BAC3B,6LAAC;gBACG,SAAS,IAAM,QAAQ,CAAC,IAAM,CAAC;gBAC/B,WAAU;;kCAEV,6LAAC,qMAAA,CAAA,OAAI;wBAAC,WAAU;;;;;;kCAChB,6LAAC;wBAAK,WAAU;kCACX;;;;;;oBAEJ,qBACG,6LAAC,mNAAA,CAAA,YAAS;wBAAC,WAAU;;;;;6CAErB,6LAAC,uNAAA,CAAA,cAAW;wBAAC,WAAU;;;;;;;;;;;;YAG9B,sBACG,6LAAC;gBAAI,WAAU;0BACX,cAAA,6LAAC;oBACG,WAAU;oBACV,SAAS;;sCAET,6LAAC,6MAAA,CAAA,SAAM;4BAAC,WAAU;;;;;;wBAAiB;;;;;;;;;;;;;;;;;;AAO3D;GA9DS;KAAA;uCAgEM","debugId":null}},
    {"offset": {"line": 163, "column": 0}, "map": {"version":3,"sources":["file:///D:/Dashboard/dashboard/src/lib/supabase.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js';\r\n\r\nexport const supabase = createClient(\r\n  process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n  process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\r\n);\r\n"],"names":[],"mappings":";;;AAGE;AAHF;;AAEO,MAAM,WAAW,CAAA,GAAA,0LAAA,CAAA,eAAY,AAAD","debugId":null}},
    {"offset": {"line": 179, "column": 0}, "map": {"version":3,"sources":["file:///D:/Dashboard/dashboard/src/components/Sidebar.tsx"],"sourcesContent":["// src/components/Sidebar.tsx\r\n\"use client\";\r\nimport { useState, useEffect } from \"react\";\r\nimport Link from \"next/link\";\r\nimport { usePathname } from \"next/navigation\";\r\nimport {\r\n    LayoutDashboard,\r\n    Settings,\r\n    BarChart2,\r\n    ChevronLeft,\r\n    X,\r\n    Sprout,\r\n    Cog,\r\n    Menu\r\n} from \"lucide-react\";\r\nimport UserProfileMenu from \"./UserProfileMenu\";\r\nimport { supabase } from \"@/lib/supabase\";\r\n\r\nconst menu = [\r\n    { label: \"Dashboard\", icon: LayoutDashboard, href: \"/dashboard\" },\r\n    { label: \"Console\", icon: Settings, href: \"/console\" },\r\n    { label: \"Result\", icon: BarChart2, href: \"/result\" },\r\n    { label: \"Settings\", icon: Cog, href: \"/setting\" },\r\n];\r\n\r\ninterface SidebarProps {\r\n    collapsed: boolean;\r\n    setCollapsed: (v: boolean) => void;\r\n    user: { firstName: string; lastName: string } | null;\r\n}\r\n\r\n// Hamburger Icon Component\r\nconst HamburgerIcon = ({ collapsed, onClick }: { collapsed: boolean; onClick: () => void }) => {\r\n    return (\r\n        <button\r\n            onClick={onClick}\r\n            className=\"flex flex-col justify-center items-center w-8 h-8 space-y-1 group\"\r\n            aria-label=\"Toggle menu\"\r\n        >\r\n            <div\r\n                className={`w-6 h-0.5 bg-white transition-all duration-300 ${collapsed ? 'rotate-0' : 'rotate-45 translate-y-2'\r\n                    }`}\r\n            />\r\n            <div\r\n                className={`w-6 h-0.5 bg-white transition-all duration-300 ${collapsed ? 'opacity-100' : 'opacity-0'\r\n                    }`}\r\n            />\r\n            <div\r\n                className={`w-6 h-0.5 bg-white transition-all duration-300 ${collapsed ? 'rotate-0' : '-rotate-45 -translate-y-2'\r\n                    }`}\r\n            />\r\n        </button>\r\n    );\r\n};\r\n\r\nexport default function Sidebar({ collapsed, setCollapsed, user }: SidebarProps) {\r\n    const [mobileOpen, setMobileOpen] = useState(false);\r\n    const pathname = usePathname();\r\n\r\n    const isActive = (href: string) => pathname === href;\r\n\r\n    // ปิด mobile menu เมื่อเปลี่ยนหน้า\r\n    useEffect(() => {\r\n        setMobileOpen(false);\r\n    }, [pathname]);\r\n\r\n    // ป้องกัน scroll เมื่อเปิด mobile menu\r\n    useEffect(() => {\r\n        if (mobileOpen) {\r\n            document.body.style.overflow = 'hidden';\r\n        } else {\r\n            document.body.style.overflow = 'unset';\r\n        }\r\n        return () => {\r\n            document.body.style.overflow = 'unset';\r\n        };\r\n    }, [mobileOpen]);\r\n\r\n    return (\r\n        <>\r\n            {/* Mobile Menu Button */}\r\n            <button\r\n                onClick={() => setMobileOpen(true)}\r\n                className=\"fixed top-4 left-4 z-50 md:hidden p-3 rounded-xl shadow-lg transition-all duration-200 hover:scale-105\"\r\n                style={{\r\n                    background: \"linear-gradient(135deg, #16a34a 0%, #22c55e 100%)\",\r\n                    boxShadow: \"0 4px 15px rgba(34, 197, 94, 0.3)\"\r\n                }}\r\n                aria-label=\"เปิดเมนู\"\r\n            >\r\n                <Menu className=\"w-6 h-6 text-white\" />\r\n            </button>\r\n\r\n            {/* Mobile Overlay */}\r\n            {mobileOpen && (\r\n                <div\r\n                    className=\"fixed inset-0 bg-black/60 z-40 md:hidden backdrop-blur-sm\"\r\n                    onClick={() => setMobileOpen(false)}\r\n                />\r\n            )}\r\n\r\n            {/* Sidebar */}\r\n            <aside\r\n                className={`\r\n                    fixed top-0 left-0 h-full z-50\r\n                    flex flex-col\r\n                    text-white shadow-2xl transition-all duration-300 ease-in-out\r\n                    border-r border-slate-700/50\r\n                    ${collapsed ? \"w-16\" : \"w-64\"}\r\n                    ${mobileOpen ? \"translate-x-0\" : \"-translate-x-full\"}\r\n                    md:translate-x-0 md:z-30\r\n                `}\r\n                style={{\r\n                    background: \"linear-gradient(180deg, #0f172a 0%, #1e293b 50%, #0f172a 100%)\",\r\n                }}\r\n            >\r\n                {/* Header */}\r\n                <div\r\n                    className=\"flex items-center justify-between p-4 border-b h-20 relative overflow-hidden\"\r\n                    style={{\r\n                        borderBottomColor: \"rgba(34, 197, 94, 0.3)\",\r\n                        background: \"linear-gradient(135deg, #064e3b 0%, #065f46 50%, #047857 100%)\"\r\n                    }}\r\n                >\r\n                    {/* Logo - แสดงเฉพาะเมื่อไม่ fold */}\r\n                    {!collapsed && (\r\n                        <Link href=\"/dashboard\" className=\"flex items-center gap-3 group relative z-10\">\r\n                            <div\r\n                                className=\"rounded-xl p-3 shadow-lg group-hover:shadow-xl transition-all duration-300\"\r\n                                style={{\r\n                                    background: \"linear-gradient(135deg, #ffffff 0%, #f0fdf4 100%)\",\r\n                                    boxShadow: \"0 8px 25px rgba(34, 197, 94, 0.2)\"\r\n                                }}\r\n                            >\r\n                                <Sprout className=\"w-7 h-7 text-green-600\" />\r\n                            </div>\r\n                            <div className=\"flex flex-col\">\r\n                                <span className=\"font-bold text-xl sm:text-2xl text-white tracking-wide\">\r\n                                    Wolffia\r\n                                </span>\r\n                                <span className=\"text-xs text-green-200 font-medium tracking-wider uppercase\">\r\n                                    Plant Dashboard\r\n                                </span>\r\n                            </div>\r\n                        </Link>\r\n                    )}\r\n\r\n                    {/* Hamburger Icon - แสดงเฉพาะเมื่อ fold */}\r\n                    {collapsed && (\r\n                        <div className=\"flex justify-center w-full\">\r\n                            <HamburgerIcon\r\n                                collapsed={collapsed}\r\n                                onClick={() => setCollapsed(!collapsed)}\r\n                            />\r\n                        </div>\r\n                    )}\r\n\r\n                    {/* Control Buttons - แสดงเฉพาะเมื่อไม่ fold */}\r\n                    {!collapsed && (\r\n                        <div className=\"flex items-center gap-2\">\r\n                            {/* Desktop collapse button */}\r\n                            <button\r\n                                onClick={() => setCollapsed(!collapsed)}\r\n                                className=\"hidden md:flex items-center justify-center w-8 h-8 rounded-lg transition-colors\"\r\n                                style={{\r\n                                    background: \"rgba(34, 197, 94, 0.1)\",\r\n                                    border: \"1px solid rgba(34, 197, 94, 0.2)\"\r\n                                }}\r\n                                aria-label=\"ย่อ/ขยายเมนู\"\r\n                            >\r\n                                <ChevronLeft className=\"w-4 h-4 text-green-300\" />\r\n                            </button>\r\n\r\n                            {/* Mobile close button */}\r\n                            <button\r\n                                onClick={() => setMobileOpen(false)}\r\n                                className=\"md:hidden flex items-center justify-center w-8 h-8 rounded-lg transition-colors\"\r\n                                style={{\r\n                                    background: \"rgba(34, 197, 94, 0.1)\",\r\n                                    border: \"1px solid rgba(34, 197, 94, 0.2)\"\r\n                                }}\r\n                                aria-label=\"ปิดเมนู\"\r\n                            >\r\n                                <X className=\"w-4 h-4 text-green-300\" />\r\n                            </button>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n\r\n                {/* Navigation Menu */}\r\n                <nav className=\"flex-1 flex flex-col py-4 px-2 space-y-2\">\r\n                    {menu.map(({ label, icon: Icon, href }) => {\r\n                        const active = isActive(href);\r\n                        return (\r\n                            <Link\r\n                                href={href}\r\n                                key={href}\r\n                                className={`\r\n                                    group relative flex items-center rounded-xl transition-all duration-200\r\n                                    ${collapsed ? \"justify-center p-3\" : \"px-4 py-3\"}\r\n                                    ${active\r\n                                        ? \"text-white font-bold shadow-lg\"\r\n                                        : \"text-slate-300 hover:text-white hover:bg-slate-700/50\"}\r\n                                `}\r\n                                style={{\r\n                                    background: active\r\n                                        ? \"linear-gradient(135deg, #16a34a 0%, #22c55e 100%)\"\r\n                                        : \"transparent\",\r\n                                }}\r\n                                onClick={() => setMobileOpen(false)}\r\n                            >\r\n                                <Icon className={`flex-shrink-0 ${collapsed ? \"w-6 h-6\" : \"w-5 h-5\"}`} />\r\n                                {!collapsed && (\r\n                                    <span className=\"ml-3 font-medium whitespace-nowrap text-sm sm:text-base\">\r\n                                        {label}\r\n                                    </span>\r\n                                )}\r\n\r\n                                {/* Tooltip for collapsed */}\r\n                                {collapsed && (\r\n                                    <div className=\"absolute left-full ml-3 px-3 py-2 bg-slate-800 text-white text-sm rounded-lg opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none whitespace-nowrap z-50 shadow-lg border border-slate-600\">\r\n                                        {label}\r\n                                    </div>\r\n                                )}\r\n                            </Link>\r\n                        );\r\n                    })}\r\n                </nav>\r\n\r\n                {/* User Profile Menu */}\r\n                <div className=\"px-2 pb-4\">\r\n                    <UserProfileMenu\r\n                        collapsed={collapsed}\r\n                        user={user}\r\n                        onLogout={async () => {\r\n                            await supabase.auth.signOut();\r\n                            setMobileOpen(false);\r\n                            window.location.href = \"/login\";\r\n                        }}\r\n                    />\r\n                </div>\r\n            </aside>\r\n        </>\r\n    );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 566, "column": 0}, "map": {"version":3,"sources":["file:///D:/Dashboard/dashboard/src/hooks/useUserProfile.ts"],"sourcesContent":["// src/hooks/useUserProfile.ts\r\nimport { useEffect, useState } from \"react\";\r\nimport { supabase } from \"@/lib/supabase\";\r\n\r\ninterface UserProfile {\r\n  firstName: string;\r\n  lastName: string;\r\n}\r\n\r\nexport function useUserProfile() {\r\n  const [userProfile, setUserProfile] = useState<UserProfile | null | undefined>(undefined);\r\n\r\n  useEffect(() => {\r\n    let ignore = false;\r\n\r\n    const getProfile = async () => {\r\n      try {\r\n        const { data: { session } } = await supabase.auth.getSession();\r\n        \r\n        if (!session?.user) {\r\n          if (!ignore) setUserProfile(null);\r\n          return;\r\n        }\r\n\r\n        // ดึงข้อมูล profile จาก profiles table\r\n        const { data: profile } = await supabase\r\n          .from('profiles')\r\n          .select('first_name, last_name')\r\n          .eq('id', session.user.id)\r\n          .single();\r\n\r\n        if (!ignore) {\r\n          if (profile) {\r\n            setUserProfile({\r\n              firstName: profile.first_name || '',\r\n              lastName: profile.last_name || ''\r\n            });\r\n          } else {\r\n            // ถ้าไม่มี profile ให้ใช้ข้อมูลจาก user metadata\r\n            setUserProfile({\r\n              firstName: session.user.user_metadata?.firstName || 'User',\r\n              lastName: session.user.user_metadata?.lastName || ''\r\n            });\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error('Profile fetch error:', error);\r\n        if (!ignore) setUserProfile(null);\r\n      }\r\n    };\r\n\r\n    getProfile();\r\n\r\n    // Listen for auth changes\r\n    const { data: { subscription } } = supabase.auth.onAuthStateChange(\r\n      async (event, session) => {\r\n        if (event === 'SIGNED_OUT') {\r\n          setUserProfile(null);\r\n          return;\r\n        }\r\n\r\n        if (session?.user) {\r\n          const { data: profile } = await supabase\r\n            .from('profiles')\r\n            .select('first_name, last_name')\r\n            .eq('id', session.user.id)\r\n            .single();\r\n\r\n          if (profile) {\r\n            setUserProfile({\r\n              firstName: profile.first_name || '',\r\n              lastName: profile.last_name || ''\r\n            });\r\n          } else {\r\n            setUserProfile({\r\n              firstName: session.user.user_metadata?.firstName || 'User',\r\n              lastName: session.user.user_metadata?.lastName || ''\r\n            });\r\n          }\r\n        } else {\r\n          setUserProfile(null);\r\n        }\r\n      }\r\n    );\r\n\r\n    return () => {\r\n      ignore = true;\r\n      subscription.unsubscribe();\r\n    };\r\n  }, []);\r\n\r\n  return userProfile;\r\n}\r\n"],"names":[],"mappings":"AAAA,8BAA8B;;;;AAC9B;AACA;;;;AAOO,SAAS;;IACd,MAAM,CAAC,aAAa,eAAe,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAkC;IAE/E,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;oCAAE;YACR,IAAI,SAAS;YAEb,MAAM;uDAAa;oBACjB,IAAI;wBACF,MAAM,EAAE,MAAM,EAAE,OAAO,EAAE,EAAE,GAAG,MAAM,yHAAA,CAAA,WAAQ,CAAC,IAAI,CAAC,UAAU;wBAE5D,IAAI,CAAC,SAAS,MAAM;4BAClB,IAAI,CAAC,QAAQ,eAAe;4BAC5B;wBACF;wBAEA,uCAAuC;wBACvC,MAAM,EAAE,MAAM,OAAO,EAAE,GAAG,MAAM,yHAAA,CAAA,WAAQ,CACrC,IAAI,CAAC,YACL,MAAM,CAAC,yBACP,EAAE,CAAC,MAAM,QAAQ,IAAI,CAAC,EAAE,EACxB,MAAM;wBAET,IAAI,CAAC,QAAQ;4BACX,IAAI,SAAS;gCACX,eAAe;oCACb,WAAW,QAAQ,UAAU,IAAI;oCACjC,UAAU,QAAQ,SAAS,IAAI;gCACjC;4BACF,OAAO;gCACL,iDAAiD;gCACjD,eAAe;oCACb,WAAW,QAAQ,IAAI,CAAC,aAAa,EAAE,aAAa;oCACpD,UAAU,QAAQ,IAAI,CAAC,aAAa,EAAE,YAAY;gCACpD;4BACF;wBACF;oBACF,EAAE,OAAO,OAAO;wBACd,QAAQ,KAAK,CAAC,wBAAwB;wBACtC,IAAI,CAAC,QAAQ,eAAe;oBAC9B;gBACF;;YAEA;YAEA,0BAA0B;YAC1B,MAAM,EAAE,MAAM,EAAE,YAAY,EAAE,EAAE,GAAG,yHAAA,CAAA,WAAQ,CAAC,IAAI,CAAC,iBAAiB;4CAChE,OAAO,OAAO;oBACZ,IAAI,UAAU,cAAc;wBAC1B,eAAe;wBACf;oBACF;oBAEA,IAAI,SAAS,MAAM;wBACjB,MAAM,EAAE,MAAM,OAAO,EAAE,GAAG,MAAM,yHAAA,CAAA,WAAQ,CACrC,IAAI,CAAC,YACL,MAAM,CAAC,yBACP,EAAE,CAAC,MAAM,QAAQ,IAAI,CAAC,EAAE,EACxB,MAAM;wBAET,IAAI,SAAS;4BACX,eAAe;gCACb,WAAW,QAAQ,UAAU,IAAI;gCACjC,UAAU,QAAQ,SAAS,IAAI;4BACjC;wBACF,OAAO;4BACL,eAAe;gCACb,WAAW,QAAQ,IAAI,CAAC,aAAa,EAAE,aAAa;gCACpD,UAAU,QAAQ,IAAI,CAAC,aAAa,EAAE,YAAY;4BACpD;wBACF;oBACF,OAAO;wBACL,eAAe;oBACjB;gBACF;;YAGF;4CAAO;oBACL,SAAS;oBACT,aAAa,WAAW;gBAC1B;;QACF;mCAAG,EAAE;IAEL,OAAO;AACT;GAnFgB","debugId":null}},
    {"offset": {"line": 657, "column": 0}, "map": {"version":3,"sources":["file:///D:/Dashboard/dashboard/src/app/%28dashboard%29/layout.tsx"],"sourcesContent":["// src/app/(dashboard)/layout.tsx\r\n\"use client\";\r\nimport { useState, useEffect } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport Sidebar from \"@/components/Sidebar\";\r\nimport { useUserProfile } from \"@/hooks/useUserProfile\";\r\n\r\nexport default function DashboardLayout({ children }: { children: React.ReactNode }) {\r\n    const [collapsed, setCollapsed] = useState(false);\r\n    const userProfile = useUserProfile();\r\n    const router = useRouter();\r\n\r\n    useEffect(() => {\r\n        if (userProfile === null) {\r\n            router.replace(\"/login\");\r\n        }\r\n    }, [userProfile, router]);\r\n\r\n    if (userProfile === undefined) {\r\n        return (\r\n            <div className=\"w-full h-screen flex items-center justify-center bg-slate-50\">\r\n                <div className=\"flex flex-col items-center gap-4\">\r\n                    <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600\"></div>\r\n                    <span className=\"text-slate-600 text-lg\">Loading...</span>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    if (userProfile === null) {\r\n        return null;\r\n    }\r\n\r\n    return (\r\n        <div className=\"flex min-h-screen bg-slate-50\">\r\n            <Sidebar\r\n                collapsed={collapsed}\r\n                setCollapsed={setCollapsed}\r\n                user={userProfile}\r\n            />\r\n            <main\r\n                className={`\r\n                    flex-1 transition-all duration-300 ease-in-out\r\n                    min-h-screen\r\n                    ${collapsed ? \"md:ml-16\" : \"md:ml-64\"}\r\n                    ml-0\r\n                    bg-white/70 dark:bg-gray-800/70 backdrop-blur-md\r\n\r\n                `}\r\n            >\r\n                <div className=\"p-4 sm:p-6 pt-20 md:pt-6\">\r\n                    {children}\r\n                </div>\r\n            </main>\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":"AAAA,iCAAiC;;;;;AAEjC;AACA;AACA;AACA;;;AAJA;;;;;AAMe,SAAS,gBAAgB,EAAE,QAAQ,EAAiC;;IAC/E,MAAM,CAAC,WAAW,aAAa,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAC3C,MAAM,cAAc,CAAA,GAAA,iIAAA,CAAA,iBAAc,AAAD;IACjC,MAAM,SAAS,CAAA,GAAA,qIAAA,CAAA,YAAS,AAAD;IAEvB,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;qCAAE;YACN,IAAI,gBAAgB,MAAM;gBACtB,OAAO,OAAO,CAAC;YACnB;QACJ;oCAAG;QAAC;QAAa;KAAO;IAExB,IAAI,gBAAgB,WAAW;QAC3B,qBACI,6LAAC;YAAI,WAAU;sBACX,cAAA,6LAAC;gBAAI,WAAU;;kCACX,6LAAC;wBAAI,WAAU;;;;;;kCACf,6LAAC;wBAAK,WAAU;kCAAyB;;;;;;;;;;;;;;;;;IAIzD;IAEA,IAAI,gBAAgB,MAAM;QACtB,OAAO;IACX;IAEA,qBACI,6LAAC;QAAI,WAAU;;0BACX,6LAAC,gIAAA,CAAA,UAAO;gBACJ,WAAW;gBACX,cAAc;gBACd,MAAM;;;;;;0BAEV,6LAAC;gBACG,WAAW,CAAC;;;oBAGR,EAAE,YAAY,aAAa,WAAW;;;;gBAI1C,CAAC;0BAED,cAAA,6LAAC;oBAAI,WAAU;8BACV;;;;;;;;;;;;;;;;;AAKrB;GAjDwB;;QAEA,iIAAA,CAAA,iBAAc;QACnB,qIAAA,CAAA,YAAS;;;KAHJ","debugId":null}}]
}